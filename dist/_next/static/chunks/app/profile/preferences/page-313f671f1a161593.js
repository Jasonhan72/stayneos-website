(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3399],{2875:function(e,t,n){Promise.resolve().then(n.bind(n,8496))},2660:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(8755).Z)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},1047:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(8755).Z)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},401:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(8755).Z)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},875:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(8755).Z)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},2451:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(8755).Z)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},407:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(8755).Z)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},9322:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(8755).Z)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},1671:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(8755).Z)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},9388:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(8755).Z)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},9202:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(8755).Z)("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]])},4938:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(8755).Z)("house",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]])},3245:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(8755).Z)("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]])},1817:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(8755).Z)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},9345:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(8755).Z)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]])},3417:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(8755).Z)("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]])},9554:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(8755).Z)("minus",[["path",{d:"M5 12h14",key:"1ays0h"}]])},9397:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(8755).Z)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},7168:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(8755).Z)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},3247:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(8755).Z)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},6865:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(8755).Z)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},5805:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(8755).Z)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])},5395:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(8755).Z)("wifi-off",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]])},2489:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(8755).Z)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},8496:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return y}});var a=n(7437),r=n(2265),s=n(7648),l=n(1579),i=n(6334),c=n(6741),o=n(2451),u=n(9345),d=n(3417);let f=(0,n(8755).Z)("megaphone",[["path",{d:"M11 6a13 13 0 0 0 8.4-2.8A1 1 0 0 1 21 4v12a1 1 0 0 1-1.6.8A13 13 0 0 0 11 14H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2z",key:"q8bfy3"}],["path",{d:"M6 14a12 12 0 0 0 2.4 7.2 2 2 0 0 0 3.2-2.4A8 8 0 0 1 10 14",key:"1853fq"}],["path",{d:"M8 6v8",key:"15ugcq"}]]);var m=n(9202),h=n(401),x=n(3448);let g=[{code:"en",label:"English",flag:"\uD83C\uDDFA\uD83C\uDDF8"},{code:"zh",label:"中文",flag:"\uD83C\uDDE8\uD83C\uDDF3"},{code:"fr",label:"Fran\xe7ais",flag:"\uD83C\uDDEB\uD83C\uDDF7"}],p=[{code:"CAD",label:"Canadian Dollar",symbol:"$"},{code:"USD",label:"US Dollar",symbol:"$"},{code:"EUR",label:"Euro",symbol:"€"},{code:"CNY",label:"Chinese Yuan",symbol:"\xa5"}];function y(){var e,t,n,y,v,b,k,j;let{user:N,updatePreferences:w,isLoading:Z}=(0,l.aF)(),[C,M]=(0,r.useState)(!1),[S,D]=(0,r.useState)({language:"en",currency:"CAD",notifications:{email:!0,sms:!0,marketing:!1}});(0,r.useEffect)(()=>{if(null==N?void 0:N.preferences){var e,t,n,a,r,s;D({language:N.preferences.language||"en",currency:N.preferences.currency||"CAD",notifications:{email:null===(a=null===(e=N.preferences.notifications)||void 0===e?void 0:e.email)||void 0===a||a,sms:null===(r=null===(t=N.preferences.notifications)||void 0===t?void 0:t.sms)||void 0===r||r,marketing:null!==(s=null===(n=N.preferences.notifications)||void 0===n?void 0:n.marketing)&&void 0!==s&&s}})}},[N]);let E=e=>{D(t=>({...t,notifications:{...t.notifications,[e]:!t.notifications[e]}}))},z=async()=>{await w({language:S.language,currency:S.currency,notifications:S.notifications}),M(!0),setTimeout(()=>M(!1),3e3)},I=S.language!==(null==N?void 0:null===(e=N.preferences)||void 0===e?void 0:e.language)||S.currency!==(null==N?void 0:null===(t=N.preferences)||void 0===t?void 0:t.currency)||S.notifications.email!==(null==N?void 0:null===(y=N.preferences)||void 0===y?void 0:null===(n=y.notifications)||void 0===n?void 0:n.email)||S.notifications.sms!==(null==N?void 0:null===(b=N.preferences)||void 0===b?void 0:null===(v=b.notifications)||void 0===v?void 0:v.sms)||S.notifications.marketing!==(null==N?void 0:null===(j=N.preferences)||void 0===j?void 0:null===(k=j.notifications)||void 0===k?void 0:k.marketing);return N?(0,a.jsx)("main",{className:"min-h-screen bg-neutral-50 pt-24 pb-12",children:(0,a.jsxs)(c.W2,{children:[(0,a.jsxs)(s.default,{href:"/profile",className:"inline-flex items-center gap-2 text-neutral-600 hover:text-neutral-900 mb-6",children:[(0,a.jsx)(o.Z,{size:20}),(0,a.jsx)("span",{children:"Back to Profile"})]}),(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-neutral-900",children:"Preferences"}),(0,a.jsx)("p",{className:"text-neutral-600 mt-2",children:"Manage your communication preferences, language, and currency settings"})]}),(0,a.jsxs)("div",{className:"max-w-2xl",children:[(0,a.jsxs)(c.Zb,{className:"mb-6",children:[(0,a.jsx)("div",{className:"p-6 border-b border-neutral-200",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center",children:(0,a.jsx)(u.Z,{className:"text-blue-600",size:20})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-neutral-900",children:"Communication preferences"}),(0,a.jsx)("p",{className:"text-sm text-neutral-500",children:"Choose how you want to hear from us"})]})]})}),(0,a.jsxs)("div",{className:"p-6 space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between py-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(u.Z,{className:"text-neutral-400",size:20}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-neutral-900",children:"Email notifications"}),(0,a.jsx)("p",{className:"text-sm text-neutral-500",children:"Receive booking confirmations and updates"})]})]}),(0,a.jsx)("button",{onClick:()=>E("email"),className:(0,x.cn)("relative w-12 h-6 rounded-full transition-colors",S.notifications.email?"bg-accent":"bg-neutral-300"),children:(0,a.jsx)("span",{className:(0,x.cn)("absolute top-1 w-4 h-4 bg-white rounded-full transition-transform",S.notifications.email?"left-7":"left-1")})})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between py-3 border-t border-neutral-100",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(d.Z,{className:"text-neutral-400",size:20}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-neutral-900",children:"SMS notifications"}),(0,a.jsx)("p",{className:"text-sm text-neutral-500",children:"Get text messages for important updates"})]})]}),(0,a.jsx)("button",{onClick:()=>E("sms"),className:(0,x.cn)("relative w-12 h-6 rounded-full transition-colors",S.notifications.sms?"bg-accent":"bg-neutral-300"),children:(0,a.jsx)("span",{className:(0,x.cn)("absolute top-1 w-4 h-4 bg-white rounded-full transition-transform",S.notifications.sms?"left-7":"left-1")})})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between py-3 border-t border-neutral-100",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(f,{className:"text-neutral-400",size:20}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-neutral-900",children:"Marketing emails"}),(0,a.jsx)("p",{className:"text-sm text-neutral-500",children:"Receive offers, discounts, and news"})]})]}),(0,a.jsx)("button",{onClick:()=>E("marketing"),className:(0,x.cn)("relative w-12 h-6 rounded-full transition-colors",S.notifications.marketing?"bg-accent":"bg-neutral-300"),children:(0,a.jsx)("span",{className:(0,x.cn)("absolute top-1 w-4 h-4 bg-white rounded-full transition-transform",S.notifications.marketing?"left-7":"left-1")})})]})]})]}),(0,a.jsxs)(c.Zb,{className:"mb-6",children:[(0,a.jsx)("div",{className:"p-6 border-b border-neutral-200",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-full bg-green-100 flex items-center justify-center",children:(0,a.jsx)(m.Z,{className:"text-green-600",size:20})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-neutral-900",children:"Language & Currency"}),(0,a.jsx)("p",{className:"text-sm text-neutral-500",children:"Set your preferred language and currency"})]})]})}),(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-3",children:"Language"}),(0,a.jsx)("div",{className:"grid grid-cols-3 gap-3",children:g.map(e=>(0,a.jsxs)("button",{onClick:()=>D(t=>({...t,language:e.code})),className:(0,x.cn)("flex items-center gap-2 p-3 rounded-lg border transition-all",S.language===e.code?"border-accent bg-accent/5":"border-neutral-200 hover:border-neutral-300"),children:[(0,a.jsx)("span",{className:"text-2xl",children:e.flag}),(0,a.jsx)("span",{className:(0,x.cn)("font-medium",S.language===e.code?"text-accent":"text-neutral-700"),children:e.label})]},e.code))})]}),(0,a.jsxs)("div",{className:"pt-4 border-t border-neutral-100",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-3",children:"Currency"}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-3",children:p.map(e=>(0,a.jsxs)("button",{onClick:()=>D(t=>({...t,currency:e.code})),className:(0,x.cn)("flex items-center gap-3 p-3 rounded-lg border transition-all",S.currency===e.code?"border-accent bg-accent/5":"border-neutral-200 hover:border-neutral-300"),children:[(0,a.jsx)("div",{className:(0,x.cn)("w-10 h-10 rounded-full flex items-center justify-center font-bold",S.currency===e.code?"bg-accent text-primary":"bg-neutral-100 text-neutral-600"),children:e.symbol}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("p",{className:(0,x.cn)("font-medium",S.currency===e.code?"text-accent":"text-neutral-700"),children:e.code}),(0,a.jsx)("p",{className:"text-xs text-neutral-500",children:e.label})]})]},e.code))})]})]})]}),C&&(0,a.jsxs)("div",{className:"mb-4 p-4 bg-green-50 border border-green-200 rounded-lg flex items-center gap-2 text-green-700",children:[(0,a.jsx)(h.Z,{size:18}),(0,a.jsx)("span",{children:"Your preferences have been saved!"})]}),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsxs)(i.default,{onClick:z,isLoading:Z,disabled:!I,children:[!Z&&(0,a.jsx)(h.Z,{size:18})," Save Changes"]})})]})]})}):(0,a.jsx)("div",{className:"min-h-screen bg-neutral-50 pt-24 pb-12",children:(0,a.jsx)(c.W2,{children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-neutral-600",children:"Please log in to view your preferences."}),(0,a.jsx)(s.default,{href:"/login",children:(0,a.jsx)(i.default,{className:"mt-4",children:"Log in"})})]})})})}},1579:function(e,t,n){"use strict";n.d(t,{Qm:function(){return m},UserProvider:function(){return u},aC:function(){return d},aF:function(){return d},hx:function(){return f}});var a=n(7437),r=n(2265),s=n(605);let l={language:"zh",currency:"CAD",notifications:{email:!0,sms:!0,marketing:!1}},i="stayneos_auth_token",c="stayneos_user_data",o=(0,r.createContext)(void 0);function u(e){let{children:t}=e,{data:n,status:u}=(0,s.useSession)(),[d,f]=(0,r.useState)(null),[m,h]=(0,r.useState)(!0);(0,r.useEffect)(()=>{(()=>{try{let e=localStorage.getItem(c),t=localStorage.getItem(i);if(e&&t){let t=JSON.parse(e);f(t)}}catch(e){console.error("Error loading user from storage:",e),localStorage.removeItem(c),localStorage.removeItem(i)}finally{h(!1)}})()},[]),(0,r.useEffect)(()=>{let e=e=>{if(e.key===c){if(e.newValue)try{let t=JSON.parse(e.newValue);f(t)}catch(e){f(null)}else f(null)}};return window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)},[]),(0,r.useEffect)(()=>{if("authenticated"===u&&(null==n?void 0:n.user)){let e=n.user.name||"",t=e.split(" "),a=t[0]||"",r=t.slice(1).join(" ")||"",s={id:n.user.id,firstName:a,lastName:r,name:e,email:n.user.email||"",image:n.user.image||void 0,avatar:n.user.image||void 0,phone:"",dateOfBirth:"",nationality:"",preferences:l,memberSince:new Date().toISOString().split("T")[0],memberLevel:"普通会员",role:n.user.role||"USER"};f(s),localStorage.setItem(c,JSON.stringify(s))}else"unauthenticated"!==u||localStorage.getItem(i)||f(null)},[n,u]);let x=(0,r.useCallback)(async e=>{h(!0);try{f(t=>{if(!t)return null;let n={...t,...e};return localStorage.setItem(c,JSON.stringify(n)),n}),await new Promise(e=>setTimeout(e,500))}finally{h(!1)}},[]),g=(0,r.useCallback)(async e=>{h(!0);try{f(t=>{if(!t)return null;let n={...t,preferences:{...t.preferences,...e,notifications:{...t.preferences.notifications,...e.notifications}}};return localStorage.setItem(c,JSON.stringify(n)),e.language&&(window.dispatchEvent(new CustomEvent("localeChange")),localStorage.setItem("preferred-locale",e.language)),n}),await new Promise(e=>setTimeout(e,300))}finally{h(!1)}},[]),p=(0,r.useCallback)(async e=>{h(!0);try{f(t=>{if(!t)return null;let n={...t,avatar:e,image:e};return localStorage.setItem(c,JSON.stringify(n)),n}),await new Promise(e=>setTimeout(e,500))}finally{h(!1)}},[]),y=(0,r.useCallback)(async()=>{localStorage.removeItem(i),localStorage.removeItem(c),f(null),window.dispatchEvent(new CustomEvent("localStorageChange")),await (0,s.signOut)({callbackUrl:"/"})},[]),v=(0,r.useCallback)(async()=>{try{let e=localStorage.getItem(i);if(!e)return;let t=await fetch("/api/auth/session",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();f(t=>{if(!t)return null;let n={...t,...e};return localStorage.setItem(c,JSON.stringify(n)),n})}else 401===t.status&&await y()}catch(e){console.error("Error refreshing user:",e)}},[y]);return(0,r.useEffect)(()=>{if(!localStorage.getItem(i))return;let e=setInterval(()=>{v()},3e5);return()=>clearInterval(e)},[v]),(0,a.jsx)(o.Provider,{value:{user:d,isLoading:m||"loading"===u,isAuthenticated:!!d,updateProfile:x,updatePreferences:g,updateAvatar:p,logout:y,refreshUser:v},children:t})}function d(){let e=(0,r.useContext)(o);if(void 0===e)throw Error("useUser must be used within a UserProvider");return e}function f(e){if(!e)return"#3B82F6";let t=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#EC4899","#06B6D4","#84CC16","#F97316","#6366F1"],n=0;for(let t=0;t<e.length;t++)n=e.charCodeAt(t)+((n<<5)-n);return t[Math.abs(n)%t.length]}function m(e){if(!e)return"?";let t=e.trim().split(/\s+/);return 1===t.length?t[0].slice(0,2).toUpperCase():(t[0][0]+t[t.length-1][0]).toUpperCase()}}},function(e){e.O(0,[7648,863,605,5883,8276,2971,2117,1744],function(){return e(e.s=2875)}),_N_E=e.O()}]);