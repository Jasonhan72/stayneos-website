(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3377],{5858:function(e,t,s){Promise.resolve().then(s.bind(s,920))},920:function(e,t,s){"use strict";s.d(t,{default:function(){return Z}});var r=s(7437),a=s(2265),n=s(9376),l=s(3145),i=s(7648),c=s(8211),o=s(3909),d=s(8672),m=s(4604),u=s(6987),x=s(257);x.env.STRIPE_SECRET_KEY&&new u.Z(x.env.STRIPE_SECRET_KEY,{apiVersion:"2026-01-28.clover"});let h=x.env.NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY||"",g=h?(0,d.J)(h):null;function f(e){let{children:t,clientSecret:s}=e;return g?(0,r.jsx)(m.eK,{stripe:g,options:s?{clientSecret:s,appearance:{theme:"stripe"}}:void 0,children:t}):(0,r.jsx)("div",{className:"p-4 bg-red-50 border border-red-200 text-red-700",children:"支付系统配置错误，请联系客服"})}var p=s(6741),j=s(8906),b=s(1817),v=s(8226);function N(e){let{amount:t,currency:s,onSuccess:n,onError:l}=e,i=(0,m.MD)(),c=(0,m.lq)(),[o,d]=(0,a.useState)(!1),[u,x]=(0,a.useState)(""),h=async e=>{if(e.preventDefault(),i&&c){d(!0),x("");try{let{error:e,paymentIntent:t}=await i.confirmPayment({elements:c,confirmParams:{return_url:"".concat(window.location.origin,"/payment/success")},redirect:"if_required"});e?(x(e.message||"支付失败，请重试"),l(e.message||"支付失败")):t&&"succeeded"===t.status?n():(x("支付状态未知，请稍后查看订单状态"),l("支付状态未知"))}catch(t){let e=t instanceof Error?t.message:"支付处理失败";x("支付处理失败，请重试"),l(e)}finally{d(!1)}}};return(0,r.jsxs)("form",{onSubmit:h,className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-green-50 border border-green-200 text-green-700 text-sm",children:[(0,r.jsx)(j.Z,{size:16}),(0,r.jsx)("span",{children:"您的支付信息已加密保护"})]}),(0,r.jsx)("div",{className:"border border-neutral-200 rounded-lg p-4",children:(0,r.jsx)(m.Hn,{options:{layout:"tabs",defaultValues:{billingDetails:{name:"",email:"",phone:"",address:{country:"CA"}}}}})}),u&&(0,r.jsx)("div",{className:"p-3 bg-red-50 border border-red-200 text-red-700 text-sm",children:u}),(0,r.jsx)(p.zx,{type:"submit",disabled:!i||o,isLoading:o,className:"w-full py-4 text-lg",children:o?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(b.Z,{className:"animate-spin mr-2",size:20}),"处理中..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(v.Z,{className:"mr-2",size:20}),"确认支付 ",new Intl.NumberFormat("en-CA",{style:"currency",currency:s}).format(t)]})}),(0,r.jsxs)("p",{className:"text-xs text-neutral-500 text-center",children:['点击"确认支付"即表示您同意我们的服务条款和隐私政策。',(0,r.jsx)("br",{}),"您的卡将在入住后24小时内被扣款。"]})]})}var y=s(6586),w=s(1427),S=s(806),k=s(3448),C=s(401),E=s(2451),I=s(9322),P=s(2023),z=s(407),D=s(2369),O=s(4938),T=s(1047),_=s(6337);function Z(){let e=(0,n.useParams)(),t=(0,n.useRouter)(),s=(0,n.useSearchParams)(),d=e.propertyId,{user:m,isAuthenticated:u}=(0,w.aC)(),{t:x}=(0,S.Q)(),h=(0,y._1)(d),g=s.get("checkIn")||"",Z=s.get("checkOut")||"",F=parseInt(s.get("guests")||"1",10),[A,B]=(0,a.useState)(g),[L,U]=(0,a.useState)(Z),[J,R]=(0,a.useState)(F),[q,M]=(0,a.useState)(""),[Y,K]=(0,a.useState)(""),[Q,V]=(0,a.useState)(""),[H,G]=(0,a.useState)("");(0,a.useEffect)(()=>{u&&m&&(M(m.name||"".concat(m.firstName||""," ").concat(m.lastName||"").trim()||""),K(m.email||""),V(m.phone||""))},[u,m]);let[X,W]=(0,a.useState)(1),[$,ee]=(0,a.useState)(!1),[et,es]=(0,a.useState)(""),[,er]=(0,a.useState)(""),[ea,en]=(0,a.useState)(""),[el,ei]=(0,a.useState)("");if((0,a.useEffect)(()=>{h||t.push("/properties")},[h,t]),!h)return null;let ec=A&&L?function(e,t,s){let r=new Date(t),a=Math.ceil((new Date(s).getTime()-r.getTime())/864e5),n=e.minNights||28,l=a>=28,i=e.price,c=1,o=0;l&&e.monthlyDiscount&&(o=e.monthlyDiscount,c=(100-e.monthlyDiscount)/100);let d=a*Math.round(i*c),m=Math.round(.1*d),u=Math.round(.13*(d+0+m));return{nights:a,basePrice:i,subtotal:d,cleaningFee:0,serviceFee:m,discount:a*i-d,discountRate:c,discountPercentage:o,tax:u,total:d+0+m+u,isMonthly:l,meetsMinNights:a>=n,minNights:n,currency:"CAD"}}(h,A,L):null,eo=A&&L?function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:28,r=new Date(e),a=new Date(t),n=new Date;return(n.setHours(0,0,0,0),isNaN(r.getTime())||isNaN(a.getTime()))?{valid:!1,error:"请选择有效的日期"}:r<n?{valid:!1,error:"入住日期不能是过去"}:a<=r?{valid:!1,error:"退房日期必须在入住日期之后"}:Math.ceil((a.getTime()-r.getTime())/864e5)<s?{valid:!1,error:"最少需要预订 ".concat(s," 天")}:{valid:!0}}(A,L,h.minNights):{valid:!0},ed=async()=>{if(!A||!L){es(x("booking.selectDatesError"));return}if(!eo.valid){es(eo.error||x("errors.selectDates"));return}let e=u?(null==m?void 0:m.name)||"".concat((null==m?void 0:m.firstName)||""," ").concat((null==m?void 0:m.lastName)||"").trim():q,t=u?null==m?void 0:m.email:Y,s=u&&(null==m?void 0:m.phone)||Q;if(!e||!t||!s){es(x("booking.fillAllInfo"));return}ee(!0),es("");try{let r=await fetch("/api/bookings/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({propertyId:h.id,propertyTitle:h.title,checkIn:A,checkOut:L,nights:(null==ec?void 0:ec.nights)||0,guests:J,guestName:e,guestEmail:t,guestPhone:s,basePrice:h.price,discountRate:(null==ec?void 0:ec.discountPercentage)||0,discountAmount:(null==ec?void 0:ec.discount)||0,serviceFee:(null==ec?void 0:ec.serviceFee)||0,totalPrice:(null==ec?void 0:ec.total)||0,specialRequests:H,userId:u?null==m?void 0:m.id:void 0})}),a=await r.json();if(!r.ok)throw Error(a.error||x("booking.createBookingError"));er(a.booking.id),ei(a.booking.bookingNumber),W(3),await em(a.booking.id)}catch(e){es(e instanceof Error?e.message:"Failed to create booking")}finally{ee(!1)}},em=async e=>{try{let t=await fetch("/api/payments/create-intent",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({bookingId:e})}),s=await t.json();if(!t.ok)throw Error(s.error||x("booking.createPaymentError"));en(s.clientSecret)}catch(e){es(e instanceof Error?e.message:x("booking.createPaymentError"))}};return(0,r.jsxs)("main",{className:"min-h-screen bg-neutral-50",children:[(0,r.jsx)("nav",{className:"bg-white border-b border-neutral-200 sticky top-0 z-40",children:(0,r.jsx)("div",{className:"container mx-auto px-4 h-16 flex items-center",children:(0,r.jsxs)(i.default,{href:"/property/".concat(h.id),className:"flex items-center gap-2 text-neutral-600 hover:text-neutral-900 transition-colors",children:[(0,r.jsx)(E.Z,{size:20}),(0,r.jsx)("span",{className:"font-medium",children:"Back to property"})]})})}),(0,r.jsx)("div",{className:"py-8",children:(0,r.jsxs)("div",{className:"container mx-auto px-4 max-w-6xl",children:[(0,r.jsx)(()=>(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("div",{className:"flex items-center justify-center max-w-2xl mx-auto",children:[1,2,3].map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:(0,k.cn)("flex items-center justify-center w-10 h-10 rounded-full font-semibold transition-colors",X>e?"bg-success text-white":X===e?"bg-primary text-white":"bg-neutral-200 text-neutral-500"),children:X>e?(0,r.jsx)(C.Z,{size:20}):e}),t<2&&(0,r.jsx)("div",{className:(0,k.cn)("w-16 h-1 mx-2 transition-colors",X>e?"bg-success":"bg-neutral-200")})]},e))}),(0,r.jsxs)("div",{className:"flex justify-center gap-12 mt-3 text-sm",children:[(0,r.jsx)("span",{className:1===X?"text-primary font-medium":"text-neutral-500",children:x("booking.step1")}),(0,r.jsx)("span",{className:2===X?"text-primary font-medium":"text-neutral-500",children:x("booking.step2")}),(0,r.jsx)("span",{className:3===X?"text-primary font-medium":"text-neutral-500",children:x("booking.step3")})]})]}),{}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,r.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[1===X&&(0,r.jsxs)("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-neutral-200",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-neutral-900 mb-6",children:"Select dates and guests"}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-semibold text-neutral-900 mb-2",children:"Check-in / Check-out"}),(0,r.jsx)(c.Z,{checkIn:A,checkOut:L,onCheckInChange:B,onCheckOutChange:U,minNights:h.minNights,monthlyDiscount:h.monthlyDiscount}),!eo.valid&&(0,r.jsxs)("div",{className:"mt-3 flex items-center gap-2 text-amber-600 text-sm bg-amber-50 p-3 rounded-lg",children:[(0,r.jsx)(I.Z,{size:16}),(0,r.jsx)("span",{children:eo.error})]}),h.monthlyDiscount&&h.monthlyDiscount>0&&(0,r.jsx)("div",{className:"mt-3 p-3 bg-accent-50 border border-accent-200 rounded-lg",children:(0,r.jsxs)("div",{className:"flex items-center gap-2 text-accent-800",children:[(0,r.jsx)(P.Z,{size:16}),(0,r.jsxs)("span",{className:"text-sm",children:[(0,r.jsxs)("span",{className:"font-semibold",children:[h.monthlyDiscount,"% off"]})," for stays of 28+ nights"]})]})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-semibold text-neutral-900 mb-2",children:"Guests"}),(0,r.jsx)("select",{value:J,onChange:e=>R(Number(e.target.value)),className:"w-full px-4 py-3 border-2 border-neutral-200 rounded-xl focus:ring-2 focus:ring-primary focus:border-primary transition-all",children:Array.from({length:h.maxGuests}).map((e,t)=>(0,r.jsxs)("option",{value:t+1,children:[t+1," ",0===t?"guest":"guests"]},t))})]})]}),(0,r.jsx)("div",{className:"mt-8 flex justify-end",children:(0,r.jsx)(p.zx,{onClick:()=>W(2),disabled:!A||!L||!eo.valid,size:"lg",rightIcon:(0,r.jsx)(z.Z,{size:18}),children:"Continue"})})]}),2===X&&(0,r.jsxs)("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-neutral-200",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-neutral-900 mb-6",children:"Confirm your information"}),(0,r.jsxs)("div",{className:"space-y-6",children:[u&&m?(0,r.jsxs)("div",{className:"bg-primary-50 border border-primary-200 rounded-xl p-5",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,r.jsx)("div",{className:"w-12 h-12 rounded-full bg-primary-100 flex items-center justify-center",children:(0,r.jsx)(D.Z,{className:"w-6 h-6 text-primary"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-semibold text-neutral-900",children:"Logged in as"}),(0,r.jsx)("p",{className:"text-sm text-neutral-500",children:"Your account information will be used"})]})]}),"                        ",(0,r.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"text-neutral-500",children:"Name: "}),(0,r.jsx)("span",{className:"font-medium",children:q})]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"text-neutral-500",children:"Email: "}),(0,r.jsx)("span",{className:"font-medium",children:Y})]}),Q&&(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"text-neutral-500",children:"Phone: "}),(0,r.jsx)("span",{className:"font-medium",children:Q})]})]}),(0,r.jsx)("div",{className:"mt-4 pt-4 border-t border-primary-200",children:(0,r.jsx)(i.default,{href:"/profile",className:"text-primary text-sm font-medium hover:underline",children:"Edit profile →"})})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsx)(p.II,{label:"Full Name *",value:q,onChange:e=>M(e.target.value),placeholder:"Enter your full name",required:!0}),(0,r.jsx)(p.II,{label:"Phone Number *",value:Q,onChange:e=>V(e.target.value),placeholder:"+1 (xxx) xxx-xxxx",required:!0})]}),(0,r.jsx)(p.II,{label:"Email Address *",type:"email",value:Y,onChange:e=>K(e.target.value),placeholder:"your@email.com",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-semibold text-neutral-900 mb-2",children:"Special Requests (Optional)"}),(0,r.jsx)("textarea",{value:H,onChange:e=>G(e.target.value),placeholder:"Any special requests or requirements...",rows:4,className:"w-full px-4 py-3 border-2 border-neutral-200 rounded-xl focus:ring-2 focus:ring-primary focus:border-primary resize-none transition-all"})]})]}),et&&(0,r.jsxs)("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-xl flex items-center gap-2 text-red-700",children:[(0,r.jsx)(I.Z,{size:18}),(0,r.jsx)("span",{children:et})]}),(0,r.jsxs)("div",{className:"mt-8 flex justify-between",children:[(0,r.jsx)(p.zx,{variant:"outline",onClick:()=>W(1),children:"Back"}),(0,r.jsx)(p.zx,{onClick:ed,disabled:$,isLoading:$,size:"lg",children:$?"Processing...":"Confirm & Pay"})]})]}),3===X&&(0,r.jsxs)("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-neutral-200",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,r.jsx)("div",{className:"w-12 h-12 bg-primary-50 rounded-full flex items-center justify-center",children:(0,r.jsx)(v.Z,{className:"w-6 h-6 text-primary"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-neutral-900",children:"Secure Payment"}),(0,r.jsx)("p",{className:"text-neutral-500",children:"Your payment information is encrypted"})]})]}),ea?(0,r.jsx)(f,{clientSecret:ea,children:(0,r.jsx)(N,{amount:(null==ec?void 0:ec.total)||0,currency:(null==ec?void 0:ec.currency)||"CAD",onSuccess:()=>{t.push("/payment/success?booking=".concat(el))},onError:e=>{es(e)}})}):(0,r.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,r.jsx)(b.Z,{className:"animate-spin mr-2 text-primary",size:24}),(0,r.jsx)("span",{children:"Loading payment details..."})]}),et&&(0,r.jsxs)("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-xl flex items-center gap-2 text-red-700",children:[(0,r.jsx)(I.Z,{size:18}),(0,r.jsx)("span",{children:et})]})]})]}),(0,r.jsx)("div",{className:"lg:col-span-1",children:(0,r.jsxs)("div",{className:"sticky top-24 bg-white rounded-2xl p-6 shadow-lg border border-neutral-200",children:[(0,r.jsxs)("div",{className:"flex gap-4 mb-6 pb-6 border-b border-neutral-100",children:[(0,r.jsx)("div",{className:"relative w-20 h-20 rounded-xl overflow-hidden",children:(0,r.jsx)(l.default,{src:h.images[0],alt:h.title,fill:!0,className:"object-cover"})}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h3",{className:"font-semibold text-neutral-900 line-clamp-2",children:h.title}),(0,r.jsxs)("div",{className:"flex items-center gap-1 text-neutral-500 text-sm mt-1",children:[(0,r.jsx)(O.Z,{size:14}),(0,r.jsx)("span",{className:"line-clamp-1",children:h.location})]})]})]}),A&&L&&(0,r.jsxs)("div",{className:"mb-6 pb-6 border-b border-neutral-100",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,r.jsx)("div",{className:"w-10 h-10 bg-neutral-100 rounded-lg flex items-center justify-center",children:(0,r.jsx)(T.Z,{size:18,className:"text-neutral-500"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs text-neutral-500",children:"Check-in"}),(0,r.jsx)("p",{className:"font-medium",children:A})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"w-10 h-10 bg-neutral-100 rounded-lg flex items-center justify-center",children:(0,r.jsx)(T.Z,{size:18,className:"text-neutral-500"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs text-neutral-500",children:"Check-out"}),(0,r.jsx)("p",{className:"font-medium",children:L})]})]})]}),ec&&(0,r.jsx)(o.UU,{basePrice:h.price,checkIn:A,checkOut:L,monthlyDiscount:h.monthlyDiscount,compact:!0}),(0,r.jsxs)("div",{className:"mt-6 pt-6 border-t border-neutral-100 space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 text-sm text-neutral-600",children:[(0,r.jsx)(j.Z,{size:16,className:"text-primary"}),(0,r.jsx)("span",{children:"Secure booking"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 text-sm text-neutral-600",children:[(0,r.jsx)(_.Z,{size:16,className:"text-primary"}),(0,r.jsx)("span",{children:"Encrypted payment"})]})]})]})})]})]})})]})}},1427:function(e,t,s){"use strict";s.d(t,{Qm:function(){return r.Qm},aC:function(){return r.aC},hx:function(){return r.hx}});var r=s(1579)},1579:function(e,t,s){"use strict";s.d(t,{Qm:function(){return x},UserProvider:function(){return d},aC:function(){return m},aF:function(){return m},hx:function(){return u}});var r=s(7437),a=s(2265),n=s(605);let l={language:"zh",currency:"CAD",notifications:{email:!0,sms:!0,marketing:!1}},i="stayneos_auth_token",c="stayneos_user_data",o=(0,a.createContext)(void 0);function d(e){let{children:t}=e,{data:s,status:d}=(0,n.useSession)(),[m,u]=(0,a.useState)(null),[x,h]=(0,a.useState)(!0);(0,a.useEffect)(()=>{(()=>{try{let e=localStorage.getItem(c),t=localStorage.getItem(i);if(e&&t){let t=JSON.parse(e);u(t)}}catch(e){console.error("Error loading user from storage:",e),localStorage.removeItem(c),localStorage.removeItem(i)}finally{h(!1)}})()},[]),(0,a.useEffect)(()=>{let e=e=>{if(e.key===c){if(e.newValue)try{let t=JSON.parse(e.newValue);u(t)}catch(e){u(null)}else u(null)}};return window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)},[]),(0,a.useEffect)(()=>{if("authenticated"===d&&(null==s?void 0:s.user)){let e=s.user.name||"",t=e.split(" "),r=t[0]||"",a=t.slice(1).join(" ")||"",n={id:s.user.id,firstName:r,lastName:a,name:e,email:s.user.email||"",image:s.user.image||void 0,avatar:s.user.image||void 0,phone:"",dateOfBirth:"",nationality:"",preferences:l,memberSince:new Date().toISOString().split("T")[0],memberLevel:"普通会员",role:s.user.role||"USER"};u(n),localStorage.setItem(c,JSON.stringify(n))}else"unauthenticated"!==d||localStorage.getItem(i)||u(null)},[s,d]);let g=(0,a.useCallback)(async e=>{h(!0);try{u(t=>{if(!t)return null;let s={...t,...e};return localStorage.setItem(c,JSON.stringify(s)),s}),await new Promise(e=>setTimeout(e,500))}finally{h(!1)}},[]),f=(0,a.useCallback)(async e=>{h(!0);try{u(t=>{if(!t)return null;let s={...t,preferences:{...t.preferences,...e,notifications:{...t.preferences.notifications,...e.notifications}}};return localStorage.setItem(c,JSON.stringify(s)),e.language&&(window.dispatchEvent(new CustomEvent("localeChange")),localStorage.setItem("preferred-locale",e.language)),s}),await new Promise(e=>setTimeout(e,300))}finally{h(!1)}},[]),p=(0,a.useCallback)(async e=>{h(!0);try{u(t=>{if(!t)return null;let s={...t,avatar:e,image:e};return localStorage.setItem(c,JSON.stringify(s)),s}),await new Promise(e=>setTimeout(e,500))}finally{h(!1)}},[]),j=(0,a.useCallback)(async()=>{localStorage.removeItem(i),localStorage.removeItem(c),u(null),window.dispatchEvent(new CustomEvent("localStorageChange")),await (0,n.signOut)({callbackUrl:"/"})},[]),b=(0,a.useCallback)(async()=>{try{let e=localStorage.getItem(i);if(!e)return;let t=await fetch("/api/auth/session",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();u(t=>{if(!t)return null;let s={...t,...e};return localStorage.setItem(c,JSON.stringify(s)),s})}else 401===t.status&&await j()}catch(e){console.error("Error refreshing user:",e)}},[j]);return(0,a.useEffect)(()=>{if(!localStorage.getItem(i))return;let e=setInterval(()=>{b()},3e5);return()=>clearInterval(e)},[b]),(0,r.jsx)(o.Provider,{value:{user:m,isLoading:x||"loading"===d,isAuthenticated:!!m,updateProfile:g,updatePreferences:f,updateAvatar:p,logout:j,refreshUser:b},children:t})}function m(){let e=(0,a.useContext)(o);if(void 0===e)throw Error("useUser must be used within a UserProvider");return e}function u(e){if(!e)return"#3B82F6";let t=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#EC4899","#06B6D4","#84CC16","#F97316","#6366F1"],s=0;for(let t=0;t<e.length;t++)s=e.charCodeAt(t)+((s<<5)-s);return t[Math.abs(s)%t.length]}function x(e){if(!e)return"?";let t=e.trim().split(/\s+/);return 1===t.length?t[0].slice(0,2).toUpperCase():(t[0][0]+t[t.length-1][0]).toUpperCase()}}},function(e){e.O(0,[7648,863,5878,605,2230,9446,5883,8276,8211,3285,2971,2117,1744],function(){return e(e.s=5858)}),_N_E=e.O()}]);