(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5926],{6426:function(e,t,s){Promise.resolve().then(s.bind(s,9725))},2660:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});let n=(0,s(8755).Z)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},1047:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});let n=(0,s(8755).Z)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},401:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});let n=(0,s(8755).Z)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},875:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});let n=(0,s(8755).Z)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},2451:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});let n=(0,s(8755).Z)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},407:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});let n=(0,s(8755).Z)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},9322:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});let n=(0,s(8755).Z)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},1671:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});let n=(0,s(8755).Z)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},9388:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});let n=(0,s(8755).Z)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},1723:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});let n=(0,s(8755).Z)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},8226:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});let n=(0,s(8755).Z)("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},2735:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});let n=(0,s(8755).Z)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]])},9202:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});let n=(0,s(8755).Z)("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]])},4938:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});let n=(0,s(8755).Z)("house",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]])},3245:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});let n=(0,s(8755).Z)("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]])},1817:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});let n=(0,s(8755).Z)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},3417:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});let n=(0,s(8755).Z)("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]])},9554:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});let n=(0,s(8755).Z)("minus",[["path",{d:"M5 12h14",key:"1ays0h"}]])},9397:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});let n=(0,s(8755).Z)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},7625:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});let n=(0,s(8755).Z)("printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]])},7168:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});let n=(0,s(8755).Z)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},3247:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});let n=(0,s(8755).Z)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},6595:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});let n=(0,s(8755).Z)("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]])},6865:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});let n=(0,s(8755).Z)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},5805:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});let n=(0,s(8755).Z)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])},5395:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});let n=(0,s(8755).Z)("wifi-off",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]])},2489:function(e,t,s){"use strict";s.d(t,{Z:function(){return n}});let n=(0,s(8755).Z)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},9725:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return v}});var n=s(7437),r=s(2265),a=s(7648),l=s(6741),i=s(1427),c=s(806),o=s(1723),u=s(401),d=s(2489),m=s(4938),x=s(1817),h=s(1047),f=s(8226),g=s(3417),p=s(2735),b=s(6595),k=s(407),y=s(7625),j=s(4594);function v(){var e;let{user:t,isAuthenticated:s}=(0,i.aC)(),{t:v}=(0,c.Q)(),[N,w]=(0,r.useState)("all"),[Z,C]=(0,r.useState)([]),[z,E]=(0,r.useState)(!0),[M,S]=(0,r.useState)(""),[_,I]=(0,r.useState)(null),[D,O]=(0,r.useState)(!1),[L,P]=(0,r.useState)(5),[F,A]=(0,r.useState)(""),B=(0,r.useCallback)(async()=>{if(!s||!t){E(!1);return}E(!0),S("");try{let e=await fetch("/api/bookings/list?userId=".concat(t.id));if(!e.ok)throw Error("Failed to fetch bookings");let s=await e.json();C(s.bookings||[])}catch(e){console.error("Error fetching bookings:",e),S(v("bookings.errorLoading"))}finally{E(!1)}},[s,t,v]);(0,r.useEffect)(()=>{B()},[B]);let H=Z.filter(e=>{let t=new Date;t.setHours(0,0,0,0);let s=new Date(e.check_in),n=new Date(e.check_out);switch(N){case"all":return"CANCELLED"!==e.status;case"upcoming":return s>t&&["PENDING","CONFIRMED"].includes(e.status);case"current":return s<=t&&n>=t&&"CANCELLED"!==e.status;case"completed":return n<t&&"CANCELLED"!==e.status||"CHECKED_OUT"===e.status;default:return!0}}),R={PENDING:{label:v("status.pending"),color:"text-yellow-700",bgColor:"bg-yellow-100",icon:o.Z},CONFIRMED:{label:v("status.confirmed"),color:"text-green-700",bgColor:"bg-green-100",icon:u.Z},CHECKED_IN:{label:v("status.checkedIn"),color:"text-blue-700",bgColor:"bg-blue-100",icon:u.Z},CHECKED_OUT:{label:v("status.checkedOut"),color:"text-gray-700",bgColor:"bg-gray-100",icon:u.Z},CANCELLED:{label:v("status.cancelled"),color:"text-red-700",bgColor:"bg-red-100",icon:d.Z}},U=e=>{let t=R[e]||R.PENDING,s=t.icon;return(0,n.jsxs)("span",{className:"px-3 py-1 text-white text-sm font-medium flex items-center gap-1 ".concat(t.bgColor.replace("bg-","bg-")),children:[(0,n.jsx)(s,{size:14}),t.label]})};return s?(0,n.jsxs)("main",{className:"min-h-screen bg-neutral-50 pt-24 pb-12",children:[(0,n.jsxs)(l.W2,{children:[(0,n.jsxs)("div",{className:"mb-8",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-neutral-900",children:v("bookings.title")}),(0,n.jsx)("p",{className:"text-neutral-600 mt-2",children:v("bookings.manageBookings")})]}),(0,n.jsx)("div",{className:"flex gap-2 mb-6 border-b border-neutral-200",children:[{id:"all",label:v("bookings.allBookings")},{id:"upcoming",label:v("bookings.upcoming")},{id:"current",label:v("bookings.current")},{id:"completed",label:v("bookings.completed")}].map(e=>(0,n.jsxs)("button",{onClick:()=>w(e.id),className:"px-6 py-3 font-medium transition-colors relative ".concat(N===e.id?"text-primary":"text-neutral-600 hover:text-neutral-900"),children:[e.label,N===e.id&&(0,n.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-primary"})]},e.id))}),z?(0,n.jsxs)("div",{className:"flex items-center justify-center py-16",children:[(0,n.jsx)(x.Z,{className:"animate-spin mr-2 text-primary",size:24}),(0,n.jsx)("span",{className:"text-neutral-600",children:v("bookings.loading")})]}):M?(0,n.jsxs)(l.Zb,{className:"p-8 text-center",children:[(0,n.jsx)("p",{className:"text-red-600",children:M}),(0,n.jsx)(l.zx,{onClick:B,className:"mt-4",children:v("bookings.retry")})]}):0===H.length?(0,n.jsxs)(l.Zb,{className:"p-12 text-center",children:[(0,n.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 bg-neutral-100 flex items-center justify-center",children:(0,n.jsx)(h.Z,{size:32,className:"text-neutral-400"})}),(0,n.jsx)("h3",{className:"text-lg font-medium text-neutral-900 mb-2",children:v("bookings.noBookings")}),(0,n.jsx)("p",{className:"text-neutral-600 mb-4",children:v("bookings.noBookings")}),(0,n.jsx)(a.default,{href:"/properties",children:(0,n.jsx)(l.zx,{children:v("nav.properties")})})]}):(0,n.jsx)("div",{className:"space-y-6",children:H.map(e=>{var t;return(0,n.jsx)(l.Zb,{className:"overflow-hidden",children:(0,n.jsxs)("div",{className:"flex flex-col lg:flex-row",children:[(0,n.jsxs)("div",{className:"relative w-full lg:w-72 h-48 lg:h-auto flex-shrink-0 bg-neutral-100 flex items-center justify-center",children:[(0,n.jsx)(m.Z,{className:"text-neutral-300",size:48}),(0,n.jsx)("div",{className:"absolute top-4 left-4 ".concat((null===(t=R[e.status])||void 0===t?void 0:t.bgColor)||"bg-gray-100"),children:U(e.status)})]}),(0,n.jsx)("div",{className:"flex-1 p-6",children:(0,n.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-start lg:justify-between gap-4",children:[(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)("div",{className:"flex items-start justify-between mb-2",children:(0,n.jsxs)("div",{children:[(0,n.jsxs)("p",{className:"text-sm text-neutral-500",children:[v("bookings.bookingNumber"),": ",e.booking_number]}),(0,n.jsx)("h3",{className:"text-xl font-semibold text-neutral-900",children:e.property_title})]})}),(0,n.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[(0,n.jsxs)("div",{className:"p-3 bg-neutral-50 border border-neutral-200",children:[(0,n.jsx)("p",{className:"text-xs text-neutral-500",children:v("bookings.checkIn")}),(0,n.jsx)("p",{className:"font-medium text-neutral-900",children:e.check_in})]}),(0,n.jsxs)("div",{className:"p-3 bg-neutral-50 border border-neutral-200",children:[(0,n.jsx)("p",{className:"text-xs text-neutral-500",children:v("bookings.checkOut")}),(0,n.jsx)("p",{className:"font-medium text-neutral-900",children:e.check_out})]}),(0,n.jsxs)("div",{className:"p-3 bg-neutral-50 border border-neutral-200",children:[(0,n.jsx)("p",{className:"text-xs text-neutral-500",children:v("bookings.nights")}),(0,n.jsxs)("p",{className:"font-medium text-neutral-900",children:[e.nights," ",v("booking.nights")]})]}),(0,n.jsxs)("div",{className:"p-3 bg-neutral-50 border border-neutral-200",children:[(0,n.jsx)("p",{className:"text-xs text-neutral-500",children:v("bookings.guests")}),(0,n.jsxs)("p",{className:"font-medium text-neutral-900",children:[e.guests," ",v("booking.guests")]})]})]}),(0,n.jsxs)("div",{className:"flex items-center gap-4",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(f.Z,{size:16,className:"text-neutral-400"}),(0,n.jsx)("span",{className:"text-sm",children:"COMPLETED"===e.payment_status?v("bookings.paid"):v("bookings.unpaid")})]}),(0,n.jsxs)("div",{className:"text-sm text-neutral-400",children:[v("bookings.bookingDate"),": ",new Date(e.created_at).toLocaleDateString("zh-CN")]})]})]}),(0,n.jsxs)("div",{className:"lg:text-right",children:[(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("p",{className:"text-sm text-neutral-500",children:v("bookings.totalPrice")}),(0,n.jsxs)("p",{className:"text-2xl font-bold text-neutral-900",children:["$",e.total_price.toLocaleString()," ",e.currency]})]}),(0,n.jsxs)("div",{className:"flex flex-wrap gap-2 justify-end",children:[["PENDING","CONFIRMED"].includes(e.status)&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(l.zx,{variant:"outline",size:"sm",children:[(0,n.jsx)(g.Z,{size:14,className:"mr-1"}),v("bookings.contactHost")]}),(0,n.jsxs)(l.zx,{variant:"outline",size:"sm",children:[(0,n.jsx)(p.Z,{size:14,className:"mr-1"}),v("bookings.downloadVoucher")]})]}),"CHECKED_OUT"===e.status&&(0,n.jsxs)(l.zx,{size:"sm",onClick:()=>{I(e),O(!0)},children:[(0,n.jsx)(b.Z,{size:14,className:"mr-1"}),v("bookings.writeReview")]}),(0,n.jsxs)(l.zx,{variant:"ghost",size:"sm",onClick:()=>I(e),children:[v("bookings.viewDetails"),(0,n.jsx)(k.Z,{size:14,className:"ml-1"})]})]})]})]})})]})},e.id)})})]}),(0,n.jsx)(l.u_,{isOpen:!!_&&!D,onClose:()=>I(null),title:v("bookings.bookingDetails"),children:_&&(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between p-4 bg-primary/5 border border-primary/20",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm text-neutral-500",children:v("bookings.bookingNumber")}),(0,n.jsx)("p",{className:"text-xl font-bold text-primary",children:_.booking_number})]}),(0,n.jsx)(l.Ct,{variant:"CONFIRMED"===_.status?"primary":"default",children:(null===(e=R[_.status])||void 0===e?void 0:e.label)||_.status})]}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm text-neutral-500",children:v("bookings.property")}),(0,n.jsx)("p",{className:"font-medium",children:_.property_title})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm text-neutral-500",children:v("booking.guestName")}),(0,n.jsx)("p",{className:"font-medium",children:_.guest_name})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm text-neutral-500",children:v("bookings.checkIn")}),(0,n.jsx)("p",{className:"font-medium",children:_.check_in})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm text-neutral-500",children:v("bookings.checkOut")}),(0,n.jsx)("p",{className:"font-medium",children:_.check_out})]})]}),(0,n.jsx)(l.iz,{}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"font-medium mb-3",children:v("bookings.priceBreakdown")}),(0,n.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{className:"text-neutral-600",children:v("bookings.basePrice")}),(0,n.jsxs)("span",{children:["$",_.total_price.toLocaleString()," ",_.currency]})]}),(0,n.jsx)(l.iz,{className:"my-2"}),(0,n.jsxs)("div",{className:"flex justify-between font-semibold text-base",children:[(0,n.jsx)("span",{children:v("booking.total")}),(0,n.jsxs)("span",{children:["$",_.total_price.toLocaleString()," ",_.currency]})]})]})]}),(0,n.jsxs)("div",{className:"flex justify-between pt-4",children:[(0,n.jsx)(l.zx,{variant:"outline",onClick:()=>I(null),children:v("bookings.close")}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsxs)(l.zx,{variant:"outline",size:"sm",children:[(0,n.jsx)(y.Z,{size:16,className:"mr-1"}),v("bookings.print")]}),(0,n.jsxs)(l.zx,{variant:"outline",size:"sm",children:[(0,n.jsx)(p.Z,{size:16,className:"mr-1"}),v("bookings.download")]})]})]})]})}),(0,n.jsx)(l.u_,{isOpen:D,onClose:()=>{O(!1),I(null)},title:v("bookings.writeReview"),children:(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("p",{className:"text-neutral-600",children:[v("bookings.writeReview")," ",null==_?void 0:_.property_title]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:v("bookings.rating")}),(0,n.jsx)("div",{className:"flex gap-2",children:Array.from({length:5}).map((e,t)=>(0,n.jsx)("button",{onClick:()=>P(t+1),className:"p-1",children:(0,n.jsx)(b.Z,{size:28,className:t<L?"text-amber-400 fill-amber-400":"text-neutral-300"})},t))})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-neutral-700 mb-2",children:v("bookings.writeReview")}),(0,n.jsx)("textarea",{value:F,onChange:e=>A(e.target.value),placeholder:v("bookings.reviewPlaceholder"),rows:4,className:"w-full px-4 py-3 border border-neutral-300 focus:border-primary focus:outline-none focus:ring-1 focus:ring-primary resize-none"})]}),(0,n.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,n.jsx)(l.zx,{variant:"ghost",onClick:()=>{O(!1),I(null)},children:v("common.cancel")}),(0,n.jsx)(l.zx,{onClick:()=>{setTimeout(()=>{O(!1),I(null),P(5),A("")},500)},children:v("bookings.submitReview")})]})]})}),(0,n.jsx)(j.Z,{})]}):(0,n.jsxs)("main",{className:"min-h-screen bg-neutral-50 pt-24 pb-12",children:[(0,n.jsx)(l.W2,{children:(0,n.jsxs)("div",{className:"bg-white rounded-xl p-12 text-center border border-neutral-200",children:[(0,n.jsx)(m.Z,{className:"w-12 h-12 text-neutral-300 mx-auto mb-4"}),(0,n.jsx)("h1",{className:"text-3xl font-bold text-neutral-900 mb-4",children:v("bookings.title")}),(0,n.jsx)("p",{className:"text-neutral-600 mb-6",children:v("bookings.pleaseLogin")}),(0,n.jsx)(a.default,{href:"/login",children:(0,n.jsx)(l.zx,{children:v("bookings.login")})})]})}),(0,n.jsx)(j.Z,{})]})}},4594:function(e,t,s){"use strict";var n=s(7437),r=s(7648),a=s(4938);t.Z=function(e){let{className:t="",variant:s="fixed"}=e;return"fixed"===s?(0,n.jsxs)(r.default,{href:"/",className:"fixed bottom-6 right-6 z-50 flex items-center gap-2 px-4 py-3 bg-primary text-white shadow-lg hover:bg-primary-700 transition-all ".concat(t),title:"返回首页",children:[(0,n.jsx)(a.Z,{size:20}),(0,n.jsx)("span",{className:"hidden sm:inline",children:"首页"})]}):(0,n.jsxs)(r.default,{href:"/",className:"inline-flex items-center gap-2 px-4 py-2 text-primary hover:text-primary-700 transition-colors ".concat(t),children:[(0,n.jsx)(a.Z,{size:18}),(0,n.jsx)("span",{children:"返回首页"})]})}},1427:function(e,t,s){"use strict";s.d(t,{Qm:function(){return n.Qm},aC:function(){return n.aC},hx:function(){return n.hx}});var n=s(1579)},1579:function(e,t,s){"use strict";s.d(t,{Qm:function(){return x},UserProvider:function(){return u},aC:function(){return d},aF:function(){return d},hx:function(){return m}});var n=s(7437),r=s(2265),a=s(605);let l={language:"zh",currency:"CAD",notifications:{email:!0,sms:!0,marketing:!1}},i="stayneos_auth_token",c="stayneos_user_data",o=(0,r.createContext)(void 0);function u(e){let{children:t}=e,{data:s,status:u}=(0,a.useSession)(),[d,m]=(0,r.useState)(null),[x,h]=(0,r.useState)(!0);(0,r.useEffect)(()=>{(()=>{try{let e=localStorage.getItem(c),t=localStorage.getItem(i);if(e&&t){let t=JSON.parse(e);m(t)}}catch(e){console.error("Error loading user from storage:",e),localStorage.removeItem(c),localStorage.removeItem(i)}finally{h(!1)}})()},[]),(0,r.useEffect)(()=>{let e=e=>{if(e.key===c){if(e.newValue)try{let t=JSON.parse(e.newValue);m(t)}catch(e){m(null)}else m(null)}};return window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)},[]),(0,r.useEffect)(()=>{if("authenticated"===u&&(null==s?void 0:s.user)){let e=s.user.name||"",t=e.split(" "),n=t[0]||"",r=t.slice(1).join(" ")||"",a={id:s.user.id,firstName:n,lastName:r,name:e,email:s.user.email||"",image:s.user.image||void 0,avatar:s.user.image||void 0,phone:"",dateOfBirth:"",nationality:"",preferences:l,memberSince:new Date().toISOString().split("T")[0],memberLevel:"普通会员",role:s.user.role||"USER"};m(a),localStorage.setItem(c,JSON.stringify(a))}else"unauthenticated"!==u||localStorage.getItem(i)||m(null)},[s,u]);let f=(0,r.useCallback)(async e=>{h(!0);try{m(t=>{if(!t)return null;let s={...t,...e};return localStorage.setItem(c,JSON.stringify(s)),s}),await new Promise(e=>setTimeout(e,500))}finally{h(!1)}},[]),g=(0,r.useCallback)(async e=>{h(!0);try{m(t=>{if(!t)return null;let s={...t,preferences:{...t.preferences,...e,notifications:{...t.preferences.notifications,...e.notifications}}};return localStorage.setItem(c,JSON.stringify(s)),e.language&&(window.dispatchEvent(new CustomEvent("localeChange")),localStorage.setItem("preferred-locale",e.language)),s}),await new Promise(e=>setTimeout(e,300))}finally{h(!1)}},[]),p=(0,r.useCallback)(async e=>{h(!0);try{m(t=>{if(!t)return null;let s={...t,avatar:e,image:e};return localStorage.setItem(c,JSON.stringify(s)),s}),await new Promise(e=>setTimeout(e,500))}finally{h(!1)}},[]),b=(0,r.useCallback)(async()=>{localStorage.removeItem(i),localStorage.removeItem(c),m(null),window.dispatchEvent(new CustomEvent("localStorageChange")),await (0,a.signOut)({callbackUrl:"/"})},[]),k=(0,r.useCallback)(async()=>{try{let e=localStorage.getItem(i);if(!e)return;let t=await fetch("/api/auth/session",{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();m(t=>{if(!t)return null;let s={...t,...e};return localStorage.setItem(c,JSON.stringify(s)),s})}else 401===t.status&&await b()}catch(e){console.error("Error refreshing user:",e)}},[b]);return(0,r.useEffect)(()=>{if(!localStorage.getItem(i))return;let e=setInterval(()=>{k()},3e5);return()=>clearInterval(e)},[k]),(0,n.jsx)(o.Provider,{value:{user:d,isLoading:x||"loading"===u,isAuthenticated:!!d,updateProfile:f,updatePreferences:g,updateAvatar:p,logout:b,refreshUser:k},children:t})}function d(){let e=(0,r.useContext)(o);if(void 0===e)throw Error("useUser must be used within a UserProvider");return e}function m(e){if(!e)return"#3B82F6";let t=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#EC4899","#06B6D4","#84CC16","#F97316","#6366F1"],s=0;for(let t=0;t<e.length;t++)s=e.charCodeAt(t)+((s<<5)-s);return t[Math.abs(s)%t.length]}function x(e){if(!e)return"?";let t=e.trim().split(/\s+/);return 1===t.length?t[0].slice(0,2).toUpperCase():(t[0][0]+t[t.length-1][0]).toUpperCase()}}},function(e){e.O(0,[7648,863,605,5883,8276,2971,2117,1744],function(){return e(e.s=6426)}),_N_E=e.O()}]);