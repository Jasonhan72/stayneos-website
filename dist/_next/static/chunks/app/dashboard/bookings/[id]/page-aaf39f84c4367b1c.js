(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9073],{4569:function(e,s,a){Promise.resolve().then(a.bind(a,4993))},4993:function(e,s,a){"use strict";a.d(s,{default:function(){return w}});var l=a(7437),t=a(2265),r=a(9376),c=a(7648),i=a(3145),n=a(6741),d=a(1723),x=a(401),m=a(4938),h=a(2489),o=a(1817),j=a(9322),N=a(2451),g=a(3774),p=a(1047),b=a(8226),u=a(6595),f=a(7625),y=a(2735);let v={PENDING:{label:"待确认",color:"bg-yellow-100 text-yellow-800",icon:d.Z},CONFIRMED:{label:"已确认",color:"bg-green-100 text-green-800",icon:x.Z},CHECKED_IN:{label:"已入住",color:"bg-blue-100 text-blue-800",icon:m.Z},CHECKED_OUT:{label:"已退房",color:"bg-gray-100 text-gray-800",icon:x.Z},CANCELLED:{label:"已取消",color:"bg-red-100 text-red-800",icon:h.Z}};function w(){var e,s;let a=(0,r.useParams)().id,[x,m]=(0,t.useState)(null),[h,w]=(0,t.useState)(!0),[E,z]=(0,t.useState)(""),Z=(0,t.useCallback)(async()=>{w(!0);try{let e=await fetch("/api/bookings/".concat(a)),s=await e.json();if(!e.ok)throw Error(s.error||"获取预订详情失败");m(s.booking)}catch(e){z(e instanceof Error?e.message:"获取预订详情失败")}finally{w(!1)}},[a]);(0,t.useEffect)(()=>{Z()},[Z]);let C=e=>new Date(e).toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric"}),k=e=>new Intl.NumberFormat("en-CA",{style:"currency",currency:(null==x?void 0:x.currency)||"CAD"}).format(e);if(h)return(0,l.jsx)("main",{className:"min-h-screen bg-amber-50",children:(0,l.jsx)("div",{className:"pt-20 pb-12",children:(0,l.jsx)("div",{className:"container mx-auto px-4 max-w-4xl",children:(0,l.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,l.jsx)(o.Z,{className:"animate-spin mr-2",size:24}),(0,l.jsx)("span",{children:"加载中..."})]})})})});if(E||!x)return(0,l.jsx)("main",{className:"min-h-screen bg-amber-50",children:(0,l.jsx)("div",{className:"pt-20 pb-12",children:(0,l.jsx)("div",{className:"container mx-auto px-4 max-w-4xl",children:(0,l.jsxs)("div",{className:"bg-white rounded-xl p-8 text-center",children:[(0,l.jsx)(j.Z,{size:48,className:"text-red-500 mx-auto mb-4"}),(0,l.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"加载失败"}),(0,l.jsx)("p",{className:"text-gray-600 mb-6",children:E||"预订不存在"}),(0,l.jsx)(c.default,{href:"/dashboard/bookings",children:(0,l.jsx)(n.zx,{children:"返回预订列表"})})]})})})});let D=(null===(e=v[x.status])||void 0===e?void 0:e.icon)||d.Z,_=v[x.status]||v.PENDING;return(0,l.jsx)("main",{className:"min-h-screen bg-amber-50",children:(0,l.jsx)("div",{className:"pt-20 pb-12",children:(0,l.jsxs)("div",{className:"container mx-auto px-4 max-w-4xl",children:[(0,l.jsxs)(c.default,{href:"/dashboard/bookings",className:"inline-flex items-center text-gray-600 hover:text-gray-900 mb-6",children:[(0,l.jsx)(N.Z,{size:20}),(0,l.jsx)("span",{children:"返回预订列表"})]}),(0,l.jsxs)("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden mb-6",children:[(0,l.jsx)("div",{className:"p-6 ".concat(_.color," bg-opacity-10"),children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"w-12 h-12 rounded-full flex items-center justify-center ".concat(_.color),children:(0,l.jsx)(D,{size:24})}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("p",{className:"text-sm text-gray-500",children:["预订号: ",x.bookingNumber]}),(0,l.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:_.label})]})]}),(0,l.jsxs)("div",{className:"text-right",children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"预订日期"}),(0,l.jsx)("p",{className:"font-medium",children:C(x.createdAt)})]})]})}),(0,l.jsx)("div",{className:"p-6",children:(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-lg font-bold text-gray-900 mb-4",children:"房源信息"}),(0,l.jsx)("div",{className:"relative aspect-video rounded-lg overflow-hidden mb-4",children:(0,l.jsx)(i.default,{src:(null===(s=x.property.images[0])||void 0===s?void 0:s.url)||"/images/placeholder.jpg",alt:x.property.title,fill:!0,className:"object-cover"})}),(0,l.jsx)(c.default,{href:"/properties/".concat(x.property.id),className:"text-lg font-semibold text-gray-900 hover:text-amber-600 transition-colors",children:x.property.title}),(0,l.jsxs)("div",{className:"flex items-center gap-1 text-gray-500 text-sm mt-1",children:[(0,l.jsx)(g.Z,{size:14}),(0,l.jsxs)("span",{children:[x.property.address,", ",x.property.city]})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-lg font-bold text-gray-900 mb-4",children:"入住信息"}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"w-10 h-10 rounded-full bg-amber-100 flex items-center justify-center",children:(0,l.jsx)(p.Z,{size:18,className:"text-amber-600"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"入住日期"}),(0,l.jsx)("p",{className:"font-medium",children:C(x.checkIn)})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"w-10 h-10 rounded-full bg-amber-100 flex items-center justify-center",children:(0,l.jsx)(p.Z,{size:18,className:"text-amber-600"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"退房日期"}),(0,l.jsx)("p",{className:"font-medium",children:C(x.checkOut)})]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"w-10 h-10 rounded-full bg-amber-100 flex items-center justify-center",children:(0,l.jsx)("span",{className:"text-amber-600 font-medium",children:x.guests})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm text-gray-500",children:"入住人数"}),(0,l.jsxs)("p",{className:"font-medium",children:[x.guests," 人 \xb7 ",x.nights," 晚"]})]})]})]}),(0,l.jsxs)("div",{className:"mt-6 pt-6 border-t border-gray-100",children:[(0,l.jsx)("h3",{className:"font-medium text-gray-900 mb-3",children:"入住人"}),(0,l.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,l.jsxs)("p",{children:[(0,l.jsx)("span",{className:"text-gray-500",children:"姓名："})," ",x.guestName]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("span",{className:"text-gray-500",children:"电话："})," ",x.guestPhone]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("span",{className:"text-gray-500",children:"邮箱："})," ",x.guestEmail]})]})]}),x.specialRequests&&(0,l.jsxs)("div",{className:"mt-6 pt-6 border-t border-gray-100",children:[(0,l.jsx)("h3",{className:"font-medium text-gray-900 mb-3",children:"特殊需求"}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:x.specialRequests})]})]})]})})]}),(0,l.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6 mb-6",children:[(0,l.jsx)("h2",{className:"text-lg font-bold text-gray-900 mb-4",children:"费用明细"}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-gray-600",children:"房费"}),(0,l.jsx)("span",{children:k(x.basePrice*x.nights)})]}),x.discount>0&&(0,l.jsxs)("div",{className:"flex justify-between text-green-600",children:[(0,l.jsx)("span",{children:"折扣"}),(0,l.jsxs)("span",{children:["-",k(x.discount)]})]}),x.cleaningFee>0&&(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-gray-600",children:"清洁费"}),(0,l.jsx)("span",{children:k(x.cleaningFee)})]}),(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-gray-600",children:"服务费"}),(0,l.jsx)("span",{children:k(x.serviceFee)})]}),(0,l.jsxs)("div",{className:"flex justify-between",children:[(0,l.jsx)("span",{className:"text-gray-600",children:"税费 (HST)"}),(0,l.jsx)("span",{children:k(x.tax)})]}),(0,l.jsx)("div",{className:"pt-4 border-t border-gray-100",children:(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)("span",{className:"font-bold text-lg",children:"总价"}),(0,l.jsx)("span",{className:"font-bold text-lg",children:k(Number(x.totalPrice))})]})})]})]}),x.payments.length>0&&(0,l.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6 mb-6",children:[(0,l.jsx)("h2",{className:"text-lg font-bold text-gray-900 mb-4",children:"支付记录"}),(0,l.jsx)("div",{className:"space-y-4",children:x.payments.map(e=>(0,l.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("div",{className:"w-10 h-10 rounded-full bg-green-100 flex items-center justify-center",children:(0,l.jsx)(b.Z,{size:18,className:"text-green-600"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-medium",children:e.cardBrand?"".concat(e.cardBrand.toUpperCase()," ****").concat(e.cardLast4):"信用卡"}),(0,l.jsx)("p",{className:"text-sm text-gray-500",children:e.paidAt?C(e.paidAt):"待支付"})]})]}),(0,l.jsx)("span",{className:"font-bold",children:k(Number(e.amount))})]},e.id))})]}),x.review&&(0,l.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6 mb-6",children:[(0,l.jsx)("h2",{className:"text-lg font-bold text-gray-900 mb-4",children:"我的评价"}),(0,l.jsxs)("div",{className:"flex items-center gap-1 mb-3",children:[Array.from({length:5}).map((e,s)=>(0,l.jsx)(u.Z,{size:20,className:s<x.review.rating?"text-amber-400 fill-amber-400":"text-gray-300"},s)),(0,l.jsx)("span",{className:"ml-2 text-gray-500",children:C(x.review.createdAt)})]}),(0,l.jsx)("p",{className:"text-gray-600",children:x.review.comment})]}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,l.jsxs)(n.zx,{variant:"outline",children:[(0,l.jsx)(f.Z,{size:18,className:"mr-2"}),"打印"]}),(0,l.jsxs)(n.zx,{variant:"outline",children:[(0,l.jsx)(y.Z,{size:18,className:"mr-2"}),"下载凭证"]}),"CHECKED_OUT"===x.status&&!x.review&&(0,l.jsxs)(n.zx,{children:[(0,l.jsx)(u.Z,{size:18,className:"mr-2"}),"写评价"]})]})]})})})}}},function(e){e.O(0,[7648,863,5878,2834,5883,8276,2971,2117,1744],function(){return e(e.s=4569)}),_N_E=e.O()}]);