(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[818],{257:function(e,t,n){"use strict";var r,s;e.exports=(null==(r=n.g.process)?void 0:r.env)&&"object"==typeof(null==(s=n.g.process)?void 0:s.env)?n.g.process:n(4227)},4227:function(e){!function(){var t={229:function(e){var t,n,r,s=e.exports={};function l(){throw Error("setTimeout has not been defined")}function i(){throw Error("clearTimeout has not been defined")}function a(e){if(t===setTimeout)return setTimeout(e,0);if((t===l||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:l}catch(e){t=l}try{n="function"==typeof clearTimeout?clearTimeout:i}catch(e){n=i}}();var c=[],o=!1,u=-1;function d(){o&&r&&(o=!1,r.length?c=r.concat(c):u=-1,c.length&&f())}function f(){if(!o){var e=a(d);o=!0;for(var t=c.length;t;){for(r=c,c=[];++u<t;)r&&r[u].run();u=-1,t=c.length}r=null,o=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===i||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function m(){}s.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new h(e,t)),1!==c.length||o||a(f)},h.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=m,s.addListener=m,s.once=m,s.off=m,s.removeListener=m,s.removeAllListeners=m,s.emit=m,s.prependListener=m,s.prependOnceListener=m,s.listeners=function(e){return[]},s.binding=function(e){throw Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw Error("process.chdir is not supported")},s.umask=function(){return 0}}},n={};function r(e){var s=n[e];if(void 0!==s)return s.exports;var l=n[e]={exports:{}},i=!0;try{t[e](l,l.exports,r),i=!1}finally{i&&delete n[e]}return l.exports}r.ab="//";var s=r(229);e.exports=s}()},9818:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return f}});var r=n(7437),s=n(2265),l=n(2489),i=n(6595),a=n(3774),c=n(7648),o=n(3145),u=n(257);let d=e=>{let t={1:{lat:43.6532,lng:-79.3832},2:{lat:43.6487,lng:-79.379}};if(!t[e]){let t=parseInt(e)||0;return{lat:43.65+.01*t+(.02*Math.random()-.01),lng:-79.38+.01*t+(.02*Math.random()-.01)}}return t[e]};function f(e){let{properties:t,selectedPropertyId:f,onPropertySelect:h}=e,m=(0,s.useRef)(null),x=(0,s.useRef)(null),p=(0,s.useRef)([]),[v,b]=(0,s.useState)(null),[g,w]=(0,s.useState)(!1);return(0,s.useEffect)(()=>((async()=>{let e=await n.e(415).then(n.t.bind(n,2520,23));if(await Promise.all([n.e(508),n.e(982)]).then(n.t.bind(n,4982,23)),!m.current||x.current)return;let r=u.env.NEXT_PUBLIC_MAPBOX_TOKEN||"pk.eyJ1IjoiZGVtb3VzZXIiLCJhIjoiY2w5Z3J6Y3N4MDZydjN1b2VqdnR1a3Q4ZyJ9.demo";e.default.accessToken=r;let s=t.length>0?d(t[0].id):{lat:43.6532,lng:-79.3832};x.current=new e.default.Map({container:m.current,style:"mapbox://styles/mapbox/light-v11",center:[s.lng,s.lat],zoom:12}),x.current.on("load",()=>{w(!0)}),x.current.addControl(new e.default.NavigationControl,"top-right")})(),()=>{x.current&&(x.current.remove(),x.current=null)}),[]),(0,s.useEffect)(()=>{(async()=>{if(!x.current||!g)return;let e=await n.e(415).then(n.t.bind(n,2520,23));if(p.current.forEach(e=>e.remove()),p.current=[],t.forEach(t=>{let n=d(t.id),r=document.createElement("div");if(r.className="property-marker",r.innerHTML='\n          <div class="marker-content '.concat(f===t.id?"selected":"",'"\n               style="\n                 background: ').concat(f===t.id?"#003B5C":"#C9A962",";\n                 color: white;\n                 padding: 6px 12px;\n                 border-radius: 0;\n                 font-weight: 600;\n                 font-size: 13px;\n                 box-shadow: 0 2px 8px rgba(0,0,0,0.3);\n                 cursor: pointer;\n                 transition: all 0.2s;\n                 white-space: nowrap;\n                 border: 2px solid white;\n               \"\n               onmouseover=\"this.style.transform='scale(1.05)';this.style.zIndex='10'\"\n               onmouseout=\"this.style.transform='scale(1)';this.style.zIndex='1'\"\n          >\n            $").concat(t.price,"\n          </div>\n        "),!x.current)return;let s=new e.default.Marker({element:r,anchor:"bottom"}).setLngLat([n.lng,n.lat]).addTo(x.current);r.addEventListener("click",()=>{var e;null==h||h(t.id),b(t),null===(e=x.current)||void 0===e||e.flyTo({center:[n.lng,n.lat],zoom:14})}),p.current.push(s)}),t.length>1){let n=new e.default.LngLatBounds;t.forEach(e=>{let t=d(e.id);n.extend([t.lng,t.lat])}),x.current.fitBounds(n,{padding:50,maxZoom:13})}})()},[t,g,f,h]),(0,s.useEffect)(()=>{if(!x.current||!f)return;let e=t.find(e=>e.id===f);if(e){let t=d(e.id);x.current.flyTo({center:[t.lng,t.lat],zoom:15}),b(e)}},[f,t]),(0,r.jsxs)("div",{className:"relative w-full h-full",children:[(0,r.jsx)("div",{ref:m,className:"w-full h-full"}),!g&&(0,r.jsx)("div",{className:"absolute inset-0 bg-neutral-100 flex items-center justify-center",children:(0,r.jsx)("div",{className:"text-neutral-400",children:"地图加载中...⏳"})}),v&&(0,r.jsx)("div",{className:"absolute bottom-4 left-4 right-4 md:left-auto md:right-4 md:w-80 z-10",children:(0,r.jsxs)("div",{className:"bg-white shadow-xl border border-neutral-200 overflow-hidden",children:[(0,r.jsx)("button",{onClick:()=>b(null),className:"absolute top-2 right-2 z-10 p-1 bg-white/90 hover:bg-white transition-colors",children:(0,r.jsx)(l.Z,{size:16})}),(0,r.jsxs)(c.default,{href:"/property/".concat(v.id),children:[(0,r.jsxs)("div",{className:"relative h-40 overflow-hidden",children:[(0,r.jsx)(o.default,{src:v.images[0],alt:v.title,fill:!0,className:"object-cover"}),v.featured&&(0,r.jsx)("div",{className:"absolute top-2 left-2 px-2 py-1 bg-accent text-white text-xs font-medium",children:"精选"})]}),(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,r.jsx)("h4",{className:"font-semibold text-neutral-900 line-clamp-1",children:v.title}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(i.Z,{size:14,className:"text-accent fill-accent"}),(0,r.jsx)("span",{className:"text-sm",children:v.rating})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1 text-neutral-500 text-sm mb-3",children:[(0,r.jsx)(a.Z,{size:12}),(0,r.jsx)("span",{className:"truncate",children:v.location})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3 text-sm text-neutral-600 mb-3",children:[(0,r.jsxs)("span",{children:[v.bedrooms,"室"]}),(0,r.jsx)("span",{children:"\xb7"}),(0,r.jsxs)("span",{children:[v.area,"m\xb2"]})]}),(0,r.jsxs)("div",{className:"flex items-baseline gap-1",children:[(0,r.jsxs)("span",{className:"text-xl font-bold text-neutral-900",children:["$",v.price.toLocaleString()]}),(0,r.jsxs)("span",{className:"text-sm text-neutral-500",children:["/",v.priceUnit]})]})]})]})]})}),(0,r.jsxs)("div",{className:"absolute top-4 left-4 bg-white p-3 shadow-lg border border-neutral-200 text-xs",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)("div",{className:"w-4 h-4 bg-accent border-2 border-white shadow"}),(0,r.jsx)("span",{children:"可预订"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-4 h-4 bg-primary border-2 border-white shadow"}),(0,r.jsx)("span",{children:"已选中"})]})]})]})}}}]);